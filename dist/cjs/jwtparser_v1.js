'use strict';

Object.defineProperty(exports, '__esModule', { value: true });

var coreutil_v1 = require('coreutil_v1');

class JwtEntry {

    /**
     * 
     * @param {String} name 
     * @param {any} value 
     */
    constructor(name, value) {

        /**
         * @type {String}
         */
        this.name = name;

        /**
         * @type {any}
         */
        this.value = value;
    }

}

class AudienceClaim extends JwtEntry {

    static get NAME() { return "aud"; }

    /**
     * 
     * @param {String} value 
     */
    constructor(value) {
        super(AudienceClaim.NAME, value);
    }

    get label() {
        return "Audience";
    }
}

class ExpiryClaim extends JwtEntry {

    static get NAME() { return "exp"; }

    /**
     * 
     * @param {String} value 
     */
    constructor(value) {
        super(ExpiryClaim.NAME, value);
    }

    get formattedValue() {
        const date = new Date(this.value * 1000);
        return "" + date.getFullYear() + "-" +
                (date.getMonth() + 1) + "-" + 
                date.getDate() + " " + 
                date.getHours() + ":" + 
                date.getMinutes() + ":" + 
                date.getSeconds();
    }

    get label() {
        return "Expiry";
    }

}

class IssuerClaim extends JwtEntry {

    static get NAME() { return "iss"; }

    /**
     * 
     * @param {String} value 
     */
    constructor(value) {
        super(IssuerClaim.NAME, value);
    }

    get label() {
        return "Issuer";
    }
}

class JwtIdClaim extends JwtEntry {

    static get NAME() { return "jti"; }

    /**
     * 
     * @param {String} value 
     */
    constructor(value) {
        super(JwtIdClaim.NAME, value);
    }

    get label() {
        return "JWT Id";
    }

}

class NotBeforeClaim extends JwtEntry {

    static get NAME() { return "nbf"; }

    /**
     * 
     * @param {String} value 
     */
    constructor(value) {
        super(NotBeforeClaim.NAME, value);
    }

    get formattedValue() {
        const date = new Date(this.value * 1000);
        return "" + date.getFullYear() + "-" +
                (date.getMonth() + 1) + "-" + 
                date.getDate() + " " + 
                date.getHours() + ":" + 
                date.getMinutes() + ":" + 
                date.getSeconds();
    }

    get label() {
        return "Not Before";
    }

}

class SubjectClaim extends JwtEntry {

    static get NAME() { return "sub"; }

    /**
     * 
     * @param {String} value 
     */
    constructor(value) {
        super(SubjectClaim.NAME, value);
    }

    get label() {
        return "Subject";
    }
}

class IssuedAtClaim extends JwtEntry {

    static get NAME() { return "iat"; }

    /**
     * 
     * @param {String} value 
     */
    constructor(value) {
        super(IssuedAtClaim.NAME, value);
    }

    get formattedValue() {
        const date = new Date(this.value * 1000);
        return "" + date.getFullYear() + "-" +
                (date.getMonth() + 1) + "-" + 
                date.getDate() + " " + 
                date.getHours() + ":" + 
                date.getMinutes() + ":" + 
                date.getSeconds();
    }

    get label() {
        return "Issued at";
    }

}

class JwtBody {

    constructor(claimsObject = null) {

        this.namedClaims = this.asMap(claimsObject);

    }

    /**
     * 
     * @param {*} value 
     * @param {*} className 
     * @returns {*}
     */
    asTypedClaim(value, className) {
        return new className(value);
    }

    asMap(claimsObject) {
        const namedClaims = new coreutil_v1.Map();
        if (claimsObject === null) {
            return namedClaims;
        }
        for ( const [key, value] of Object.entries(claimsObject)) {
            namedClaims.set(key, this.asMappedClaim(key, value));
        }
        return namedClaims;
    }

    /**
     * 
     * @param {String} name 
     * @returns {JwtEntry}
     */
    getNamedClaim(name) {
        return this.namedClaims.get(name);
    }

    /**
     * 
     * @param {String} name 
     * @returns {JwtEntry}
     */
     getNamedClaimValue(name) {
        if (this.namedClaims.get(name)) {
            return this.namedClaims.get(name).value;
        }
        return null;
    }

    /**
     * 
     * @param {String} key 
     * @param {String} value 
     * @returns {JwtEntry}
     */
    asMappedClaim(key, value) {

        if (coreutil_v1.StringUtils.nonNullEquals(key, SubjectClaim.NAME)) {
            return this.asTypedClaim(value, SubjectClaim);
        }
        if (coreutil_v1.StringUtils.nonNullEquals(key, IssuerClaim.NAME)) {
            return this.asTypedClaim(value, IssuerClaim);
        }
        if (coreutil_v1.StringUtils.nonNullEquals(key, AudienceClaim.NAME)) {
            return this.asTypedClaim(value, AudienceClaim);
        }
        if (coreutil_v1.StringUtils.nonNullEquals(key, JwtIdClaim.NAME)) {
            return this.asTypedClaim(value, JwtIdClaim);
        }
        if (coreutil_v1.StringUtils.nonNullEquals(key, ExpiryClaim.NAME)) {
            return this.asTypedClaim(value, ExpiryClaim);
        }
        if (coreutil_v1.StringUtils.nonNullEquals(key, NotBeforeClaim.NAME)) {
            return this.asTypedClaim(value, NotBeforeClaim);
        }
        if (coreutil_v1.StringUtils.nonNullEquals(key, IssuedAtClaim.NAME)) {
            return this.asTypedClaim(value, IssuedAtClaim);
        }
        return new JwtEntry(key, value);
         
    }

    get sub() {
        return this.getNamedClaimValue(SubjectClaim.NAME);
    }

    get iss() {
        return this.getNamedClaimValue(IssuerClaim.NAME);
    }

    get aud() {
        return this.getNamedClaimValue(AudienceClaim.NAME);
    }

    get jti() {
        return this.getNamedClaimValue(JwtIdClaim.NAME);
    }

    get exp() {
        return this.getNamedClaimValue(ExpiryClaim.NAME);
    }

    get nbf() {
        return this.getNamedClaimValue(NotBeforeClaim.NAME);
    }

    get iat() {
        return this.getNamedClaimValue(IssuedAtClaim.NAME);
    }
}

class AlgorithmMeta extends JwtEntry {

    static get NAME() { return "alg"; }

    /**
     * 
     * @param {String} value 
     */
    constructor(value) {
        super(AlgorithmMeta.NAME, value);
    }

}

class TypeMeta extends JwtEntry {

    static get NAME() { return "typ"; }

    /**
     * 
     * @param {String} value 
     */
    constructor(value) {
        super(TypeMeta.NAME, value);
    }

}

class KeyIdMeta extends JwtEntry {

    static get NAME() { return "kid"; }

    /**
     * 
     * @param {String} value 
     */
    constructor(value) {
        super(KeyIdMeta.NAME, value);
    }

}

class JwtHeader {

    constructor(metaObject) {

        /**
         * @type {AlgorithmMeta}
         */
        this.algorithm = this.getMeta(metaObject, AlgorithmMeta.NAME, AlgorithmMeta);

        /**
         * @type {TypeMeta}
         */
        this.type = this.getMeta(metaObject, TypeMeta.NAME, TypeMeta);

        /**
         * @type {TypeMeta}
         */
         this.kid = this.getMeta(metaObject, KeyIdMeta.NAME, KeyIdMeta);
    }

    /**
     * 
     * @param {*} metaObject 
     * @param {*} attributeName 
     */
    getMeta(metaObject, attributeName, className) {
        if (metaObject === null) {
            return null;
        }
        const metaValue = metaObject[attributeName];
        if(metaValue === null || metaValue === undefined) {
            return null;
        }
        return new className(metaValue);
    }

}

class Jwt {

    constructor(stringSource, jwtHeader, jwtBody) {
        /**
         * @type {String}
         */
        this.source = stringSource;

        /**
         * @type {JwtHeader}
         */
        this.header = jwtHeader;

        /**
         * @type {JwtBody}
         */
        this.body = jwtBody;
    }

}

class JwtStringParser {

    /**
     * 
     * @param {String} jwtString
     * @returns {Jwt} jwt
     */
    static parseString(jwtString) {
        /**
         * @type [Array]
         */
        const jwtParts = jwtString.split(".");
        if(jwtParts.length < 2) {
            throw "JWT does not have a body";
        }
        
        const headerDecoded = atob(jwtParts[0]);
        const headerObject = JSON.parse(headerDecoded);
        const jwtHeader = new JwtHeader(headerObject);

        const bodyDecoded = atob(jwtParts[1]);
        const bodyObject = JSON.parse(bodyDecoded);
        const jwtBody = new JwtBody(bodyObject);

        return new Jwt(jwtString, jwtHeader, jwtBody);
    }

}

exports.AlgorithmMeta = AlgorithmMeta;
exports.AudienceClaim = AudienceClaim;
exports.ExpiryClaim = ExpiryClaim;
exports.IssuedAtClaim = IssuedAtClaim;
exports.IssuerClaim = IssuerClaim;
exports.Jwt = Jwt;
exports.JwtBody = JwtBody;
exports.JwtEntry = JwtEntry;
exports.JwtHeader = JwtHeader;
exports.JwtIdClaim = JwtIdClaim;
exports.JwtStringParser = JwtStringParser;
exports.KeyIdMeta = KeyIdMeta;
exports.NotBeforeClaim = NotBeforeClaim;
exports.SubjectClaim = SubjectClaim;
exports.TypeMeta = TypeMeta;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiand0cGFyc2VyX3YxLmpzIiwic291cmNlcyI6WyIuLi8uLi9zcmMvand0cGFyc2VyL21vZGVsL2p3dEVudHJ5LmpzIiwiLi4vLi4vc3JjL2p3dHBhcnNlci9tb2RlbC9ib2R5L2F1ZGllbmNlQ2xhaW0uanMiLCIuLi8uLi9zcmMvand0cGFyc2VyL21vZGVsL2JvZHkvZXhwaXJ5Q2xhaW0uanMiLCIuLi8uLi9zcmMvand0cGFyc2VyL21vZGVsL2JvZHkvaXNzdWVyQ2xhaW0uanMiLCIuLi8uLi9zcmMvand0cGFyc2VyL21vZGVsL2JvZHkvand0SWRDbGFpbS5qcyIsIi4uLy4uL3NyYy9qd3RwYXJzZXIvbW9kZWwvYm9keS9ub3RCZWZvcmVDbGFpbS5qcyIsIi4uLy4uL3NyYy9qd3RwYXJzZXIvbW9kZWwvYm9keS9zdWJqZWN0Q2xhaW0uanMiLCIuLi8uLi9zcmMvand0cGFyc2VyL21vZGVsL2JvZHkvaXNzdWVkQXRDbGFpbS5qcyIsIi4uLy4uL3NyYy9qd3RwYXJzZXIvbW9kZWwvand0Qm9keS5qcyIsIi4uLy4uL3NyYy9qd3RwYXJzZXIvbW9kZWwvaGVhZGVyL2FsZ29yaXRobU1ldGEuanMiLCIuLi8uLi9zcmMvand0cGFyc2VyL21vZGVsL2hlYWRlci90eXBlTWV0YS5qcyIsIi4uLy4uL3NyYy9qd3RwYXJzZXIvbW9kZWwvaGVhZGVyL2tleUlkTWV0YS5qcyIsIi4uLy4uL3NyYy9qd3RwYXJzZXIvbW9kZWwvand0SGVhZGVyLmpzIiwiLi4vLi4vc3JjL2p3dHBhcnNlci9tb2RlbC9qd3QuanMiLCIuLi8uLi9zcmMvand0cGFyc2VyL2p3dFN0cmluZ1BhcnNlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY2xhc3MgSnd0RW50cnkge1xuXG4gICAgLyoqXG4gICAgICogXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IG5hbWUgXG4gICAgICogQHBhcmFtIHthbnl9IHZhbHVlIFxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKG5hbWUsIHZhbHVlKSB7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEB0eXBlIHtTdHJpbmd9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAdHlwZSB7YW55fVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuICAgIH1cblxufSIsImltcG9ydCB7IEp3dEVudHJ5IH0gZnJvbSBcIi4uL2p3dEVudHJ5LmpzXCI7XG5cbmV4cG9ydCBjbGFzcyBBdWRpZW5jZUNsYWltIGV4dGVuZHMgSnd0RW50cnkge1xuXG4gICAgc3RhdGljIGdldCBOQU1FKCkgeyByZXR1cm4gXCJhdWRcIjsgfVxuXG4gICAgLyoqXG4gICAgICogXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHZhbHVlIFxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHZhbHVlKSB7XG4gICAgICAgIHN1cGVyKEF1ZGllbmNlQ2xhaW0uTkFNRSwgdmFsdWUpO1xuICAgIH1cblxuICAgIGdldCBsYWJlbCgpIHtcbiAgICAgICAgcmV0dXJuIFwiQXVkaWVuY2VcIjtcbiAgICB9XG59IiwiaW1wb3J0IHsgSnd0RW50cnkgfSBmcm9tIFwiLi4vand0RW50cnkuanNcIjtcblxuZXhwb3J0IGNsYXNzIEV4cGlyeUNsYWltIGV4dGVuZHMgSnd0RW50cnkge1xuXG4gICAgc3RhdGljIGdldCBOQU1FKCkgeyByZXR1cm4gXCJleHBcIjsgfVxuXG4gICAgLyoqXG4gICAgICogXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHZhbHVlIFxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHZhbHVlKSB7XG4gICAgICAgIHN1cGVyKEV4cGlyeUNsYWltLk5BTUUsIHZhbHVlKTtcbiAgICB9XG5cbiAgICBnZXQgZm9ybWF0dGVkVmFsdWUoKSB7XG4gICAgICAgIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZSh0aGlzLnZhbHVlICogMTAwMCk7XG4gICAgICAgIHJldHVybiBcIlwiICsgZGF0ZS5nZXRGdWxsWWVhcigpICsgXCItXCIgK1xuICAgICAgICAgICAgICAgIChkYXRlLmdldE1vbnRoKCkgKyAxKSArIFwiLVwiICsgXG4gICAgICAgICAgICAgICAgZGF0ZS5nZXREYXRlKCkgKyBcIiBcIiArIFxuICAgICAgICAgICAgICAgIGRhdGUuZ2V0SG91cnMoKSArIFwiOlwiICsgXG4gICAgICAgICAgICAgICAgZGF0ZS5nZXRNaW51dGVzKCkgKyBcIjpcIiArIFxuICAgICAgICAgICAgICAgIGRhdGUuZ2V0U2Vjb25kcygpO1xuICAgIH1cblxuICAgIGdldCBsYWJlbCgpIHtcbiAgICAgICAgcmV0dXJuIFwiRXhwaXJ5XCI7XG4gICAgfVxuXG59IiwiaW1wb3J0IHsgSnd0RW50cnkgfSBmcm9tIFwiLi4vand0RW50cnkuanNcIjtcblxuZXhwb3J0IGNsYXNzIElzc3VlckNsYWltIGV4dGVuZHMgSnd0RW50cnkge1xuXG4gICAgc3RhdGljIGdldCBOQU1FKCkgeyByZXR1cm4gXCJpc3NcIjsgfVxuXG4gICAgLyoqXG4gICAgICogXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHZhbHVlIFxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHZhbHVlKSB7XG4gICAgICAgIHN1cGVyKElzc3VlckNsYWltLk5BTUUsIHZhbHVlKTtcbiAgICB9XG5cbiAgICBnZXQgbGFiZWwoKSB7XG4gICAgICAgIHJldHVybiBcIklzc3VlclwiO1xuICAgIH1cbn0iLCJpbXBvcnQgeyBKd3RFbnRyeSB9IGZyb20gXCIuLi9qd3RFbnRyeS5qc1wiO1xuXG5leHBvcnQgY2xhc3MgSnd0SWRDbGFpbSBleHRlbmRzIEp3dEVudHJ5IHtcblxuICAgIHN0YXRpYyBnZXQgTkFNRSgpIHsgcmV0dXJuIFwianRpXCI7IH1cblxuICAgIC8qKlxuICAgICAqIFxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSB2YWx1ZSBcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcih2YWx1ZSkge1xuICAgICAgICBzdXBlcihKd3RJZENsYWltLk5BTUUsIHZhbHVlKTtcbiAgICB9XG5cbiAgICBnZXQgbGFiZWwoKSB7XG4gICAgICAgIHJldHVybiBcIkpXVCBJZFwiO1xuICAgIH1cblxufSIsImltcG9ydCB7IEp3dEVudHJ5IH0gZnJvbSBcIi4uL2p3dEVudHJ5LmpzXCI7XG5cbmV4cG9ydCBjbGFzcyBOb3RCZWZvcmVDbGFpbSBleHRlbmRzIEp3dEVudHJ5IHtcblxuICAgIHN0YXRpYyBnZXQgTkFNRSgpIHsgcmV0dXJuIFwibmJmXCI7IH1cblxuICAgIC8qKlxuICAgICAqIFxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSB2YWx1ZSBcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcih2YWx1ZSkge1xuICAgICAgICBzdXBlcihOb3RCZWZvcmVDbGFpbS5OQU1FLCB2YWx1ZSk7XG4gICAgfVxuXG4gICAgZ2V0IGZvcm1hdHRlZFZhbHVlKCkge1xuICAgICAgICBjb25zdCBkYXRlID0gbmV3IERhdGUodGhpcy52YWx1ZSAqIDEwMDApO1xuICAgICAgICByZXR1cm4gXCJcIiArIGRhdGUuZ2V0RnVsbFllYXIoKSArIFwiLVwiICtcbiAgICAgICAgICAgICAgICAoZGF0ZS5nZXRNb250aCgpICsgMSkgKyBcIi1cIiArIFxuICAgICAgICAgICAgICAgIGRhdGUuZ2V0RGF0ZSgpICsgXCIgXCIgKyBcbiAgICAgICAgICAgICAgICBkYXRlLmdldEhvdXJzKCkgKyBcIjpcIiArIFxuICAgICAgICAgICAgICAgIGRhdGUuZ2V0TWludXRlcygpICsgXCI6XCIgKyBcbiAgICAgICAgICAgICAgICBkYXRlLmdldFNlY29uZHMoKTtcbiAgICB9XG5cbiAgICBnZXQgbGFiZWwoKSB7XG4gICAgICAgIHJldHVybiBcIk5vdCBCZWZvcmVcIjtcbiAgICB9XG5cbn0iLCJpbXBvcnQgeyBKd3RFbnRyeSB9IGZyb20gXCIuLi9qd3RFbnRyeS5qc1wiO1xuXG5leHBvcnQgY2xhc3MgU3ViamVjdENsYWltIGV4dGVuZHMgSnd0RW50cnkge1xuXG4gICAgc3RhdGljIGdldCBOQU1FKCkgeyByZXR1cm4gXCJzdWJcIjsgfVxuXG4gICAgLyoqXG4gICAgICogXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHZhbHVlIFxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHZhbHVlKSB7XG4gICAgICAgIHN1cGVyKFN1YmplY3RDbGFpbS5OQU1FLCB2YWx1ZSk7XG4gICAgfVxuXG4gICAgZ2V0IGxhYmVsKCkge1xuICAgICAgICByZXR1cm4gXCJTdWJqZWN0XCI7XG4gICAgfVxufSIsImltcG9ydCB7IEp3dEVudHJ5IH0gZnJvbSBcIi4uL2p3dEVudHJ5LmpzXCI7XG5cbmV4cG9ydCBjbGFzcyBJc3N1ZWRBdENsYWltIGV4dGVuZHMgSnd0RW50cnkge1xuXG4gICAgc3RhdGljIGdldCBOQU1FKCkgeyByZXR1cm4gXCJpYXRcIjsgfVxuXG4gICAgLyoqXG4gICAgICogXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHZhbHVlIFxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHZhbHVlKSB7XG4gICAgICAgIHN1cGVyKElzc3VlZEF0Q2xhaW0uTkFNRSwgdmFsdWUpO1xuICAgIH1cblxuICAgIGdldCBmb3JtYXR0ZWRWYWx1ZSgpIHtcbiAgICAgICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKHRoaXMudmFsdWUgKiAxMDAwKTtcbiAgICAgICAgcmV0dXJuIFwiXCIgKyBkYXRlLmdldEZ1bGxZZWFyKCkgKyBcIi1cIiArXG4gICAgICAgICAgICAgICAgKGRhdGUuZ2V0TW9udGgoKSArIDEpICsgXCItXCIgKyBcbiAgICAgICAgICAgICAgICBkYXRlLmdldERhdGUoKSArIFwiIFwiICsgXG4gICAgICAgICAgICAgICAgZGF0ZS5nZXRIb3VycygpICsgXCI6XCIgKyBcbiAgICAgICAgICAgICAgICBkYXRlLmdldE1pbnV0ZXMoKSArIFwiOlwiICsgXG4gICAgICAgICAgICAgICAgZGF0ZS5nZXRTZWNvbmRzKCk7XG4gICAgfVxuXG4gICAgZ2V0IGxhYmVsKCkge1xuICAgICAgICByZXR1cm4gXCJJc3N1ZWQgYXRcIjtcbiAgICB9XG5cbn0iLCJpbXBvcnQgeyBNYXAsIFN0cmluZ1V0aWxzIH0gZnJvbSBcImNvcmV1dGlsX3YxXCJcbmltcG9ydCB7IEF1ZGllbmNlQ2xhaW0gfSBmcm9tIFwiLi9ib2R5L2F1ZGllbmNlQ2xhaW0uanNcIjtcbmltcG9ydCB7IEp3dEVudHJ5IH0gZnJvbSBcIi4vand0RW50cnkuanNcIjtcbmltcG9ydCB7IEV4cGlyeUNsYWltIH0gZnJvbSBcIi4vYm9keS9leHBpcnlDbGFpbS5qc1wiO1xuaW1wb3J0IHsgSXNzdWVyQ2xhaW0gfSBmcm9tIFwiLi9ib2R5L2lzc3VlckNsYWltLmpzXCI7XG5pbXBvcnQgeyBKd3RJZENsYWltIH0gZnJvbSBcIi4vYm9keS9qd3RJZENsYWltLmpzXCI7XG5pbXBvcnQgeyBOb3RCZWZvcmVDbGFpbSB9IGZyb20gXCIuL2JvZHkvbm90QmVmb3JlQ2xhaW0uanNcIjtcbmltcG9ydCB7IFN1YmplY3RDbGFpbSB9IGZyb20gXCIuL2JvZHkvc3ViamVjdENsYWltLmpzXCI7XG5pbXBvcnQgeyBJc3N1ZWRBdENsYWltIH0gZnJvbSBcIi4vYm9keS9pc3N1ZWRBdENsYWltLmpzXCI7XG5cblxuZXhwb3J0IGNsYXNzIEp3dEJvZHkge1xuXG4gICAgY29uc3RydWN0b3IoY2xhaW1zT2JqZWN0ID0gbnVsbCkge1xuXG4gICAgICAgIHRoaXMubmFtZWRDbGFpbXMgPSB0aGlzLmFzTWFwKGNsYWltc09iamVjdCk7XG5cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBcbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFxuICAgICAqIEBwYXJhbSB7Kn0gY2xhc3NOYW1lIFxuICAgICAqIEByZXR1cm5zIHsqfVxuICAgICAqL1xuICAgIGFzVHlwZWRDbGFpbSh2YWx1ZSwgY2xhc3NOYW1lKSB7XG4gICAgICAgIHJldHVybiBuZXcgY2xhc3NOYW1lKHZhbHVlKTtcbiAgICB9XG5cbiAgICBhc01hcChjbGFpbXNPYmplY3QpIHtcbiAgICAgICAgY29uc3QgbmFtZWRDbGFpbXMgPSBuZXcgTWFwKCk7XG4gICAgICAgIGlmIChjbGFpbXNPYmplY3QgPT09IG51bGwpIHtcbiAgICAgICAgICAgIHJldHVybiBuYW1lZENsYWltcztcbiAgICAgICAgfVxuICAgICAgICBmb3IgKCBjb25zdCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMoY2xhaW1zT2JqZWN0KSkge1xuICAgICAgICAgICAgbmFtZWRDbGFpbXMuc2V0KGtleSwgdGhpcy5hc01hcHBlZENsYWltKGtleSwgdmFsdWUpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmFtZWRDbGFpbXM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IG5hbWUgXG4gICAgICogQHJldHVybnMge0p3dEVudHJ5fVxuICAgICAqL1xuICAgIGdldE5hbWVkQ2xhaW0obmFtZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5uYW1lZENsYWltcy5nZXQobmFtZSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IG5hbWUgXG4gICAgICogQHJldHVybnMge0p3dEVudHJ5fVxuICAgICAqL1xuICAgICBnZXROYW1lZENsYWltVmFsdWUobmFtZSkge1xuICAgICAgICBpZiAodGhpcy5uYW1lZENsYWltcy5nZXQobmFtZSkpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm5hbWVkQ2xhaW1zLmdldChuYW1lKS52YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30ga2V5IFxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSB2YWx1ZSBcbiAgICAgKiBAcmV0dXJucyB7Snd0RW50cnl9XG4gICAgICovXG4gICAgYXNNYXBwZWRDbGFpbShrZXksIHZhbHVlKSB7XG5cbiAgICAgICAgaWYgKFN0cmluZ1V0aWxzLm5vbk51bGxFcXVhbHMoa2V5LCBTdWJqZWN0Q2xhaW0uTkFNRSkpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmFzVHlwZWRDbGFpbSh2YWx1ZSwgU3ViamVjdENsYWltKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoU3RyaW5nVXRpbHMubm9uTnVsbEVxdWFscyhrZXksIElzc3VlckNsYWltLk5BTUUpKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5hc1R5cGVkQ2xhaW0odmFsdWUsIElzc3VlckNsYWltKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoU3RyaW5nVXRpbHMubm9uTnVsbEVxdWFscyhrZXksIEF1ZGllbmNlQ2xhaW0uTkFNRSkpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmFzVHlwZWRDbGFpbSh2YWx1ZSwgQXVkaWVuY2VDbGFpbSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFN0cmluZ1V0aWxzLm5vbk51bGxFcXVhbHMoa2V5LCBKd3RJZENsYWltLk5BTUUpKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5hc1R5cGVkQ2xhaW0odmFsdWUsIEp3dElkQ2xhaW0pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChTdHJpbmdVdGlscy5ub25OdWxsRXF1YWxzKGtleSwgRXhwaXJ5Q2xhaW0uTkFNRSkpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmFzVHlwZWRDbGFpbSh2YWx1ZSwgRXhwaXJ5Q2xhaW0pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChTdHJpbmdVdGlscy5ub25OdWxsRXF1YWxzKGtleSwgTm90QmVmb3JlQ2xhaW0uTkFNRSkpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmFzVHlwZWRDbGFpbSh2YWx1ZSwgTm90QmVmb3JlQ2xhaW0pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChTdHJpbmdVdGlscy5ub25OdWxsRXF1YWxzKGtleSwgSXNzdWVkQXRDbGFpbS5OQU1FKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYXNUeXBlZENsYWltKHZhbHVlLCBJc3N1ZWRBdENsYWltKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3IEp3dEVudHJ5KGtleSwgdmFsdWUpO1xuICAgICAgICAgXG4gICAgfVxuXG4gICAgZ2V0IHN1YigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0TmFtZWRDbGFpbVZhbHVlKFN1YmplY3RDbGFpbS5OQU1FKTtcbiAgICB9XG5cbiAgICBnZXQgaXNzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXROYW1lZENsYWltVmFsdWUoSXNzdWVyQ2xhaW0uTkFNRSk7XG4gICAgfVxuXG4gICAgZ2V0IGF1ZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0TmFtZWRDbGFpbVZhbHVlKEF1ZGllbmNlQ2xhaW0uTkFNRSk7XG4gICAgfVxuXG4gICAgZ2V0IGp0aSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0TmFtZWRDbGFpbVZhbHVlKEp3dElkQ2xhaW0uTkFNRSk7XG4gICAgfVxuXG4gICAgZ2V0IGV4cCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0TmFtZWRDbGFpbVZhbHVlKEV4cGlyeUNsYWltLk5BTUUpO1xuICAgIH1cblxuICAgIGdldCBuYmYoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldE5hbWVkQ2xhaW1WYWx1ZShOb3RCZWZvcmVDbGFpbS5OQU1FKTtcbiAgICB9XG5cbiAgICBnZXQgaWF0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXROYW1lZENsYWltVmFsdWUoSXNzdWVkQXRDbGFpbS5OQU1FKTtcbiAgICB9XG59IiwiaW1wb3J0IHsgSnd0RW50cnkgfSBmcm9tIFwiLi4vand0RW50cnkuanNcIjtcblxuZXhwb3J0IGNsYXNzIEFsZ29yaXRobU1ldGEgZXh0ZW5kcyBKd3RFbnRyeSB7XG5cbiAgICBzdGF0aWMgZ2V0IE5BTUUoKSB7IHJldHVybiBcImFsZ1wiOyB9XG5cbiAgICAvKipcbiAgICAgKiBcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gdmFsdWUgXG4gICAgICovXG4gICAgY29uc3RydWN0b3IodmFsdWUpIHtcbiAgICAgICAgc3VwZXIoQWxnb3JpdGhtTWV0YS5OQU1FLCB2YWx1ZSlcbiAgICB9XG5cbn0iLCJpbXBvcnQgeyBKd3RFbnRyeSB9IGZyb20gXCIuLi9qd3RFbnRyeS5qc1wiO1xuXG5leHBvcnQgY2xhc3MgVHlwZU1ldGEgZXh0ZW5kcyBKd3RFbnRyeSB7XG5cbiAgICBzdGF0aWMgZ2V0IE5BTUUoKSB7IHJldHVybiBcInR5cFwiOyB9XG5cbiAgICAvKipcbiAgICAgKiBcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gdmFsdWUgXG4gICAgICovXG4gICAgY29uc3RydWN0b3IodmFsdWUpIHtcbiAgICAgICAgc3VwZXIoVHlwZU1ldGEuTkFNRSwgdmFsdWUpXG4gICAgfVxuXG59IiwiaW1wb3J0IHsgSnd0RW50cnkgfSBmcm9tIFwiLi4vand0RW50cnkuanNcIjtcblxuZXhwb3J0IGNsYXNzIEtleUlkTWV0YSBleHRlbmRzIEp3dEVudHJ5IHtcblxuICAgIHN0YXRpYyBnZXQgTkFNRSgpIHsgcmV0dXJuIFwia2lkXCI7IH1cblxuICAgIC8qKlxuICAgICAqIFxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSB2YWx1ZSBcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcih2YWx1ZSkge1xuICAgICAgICBzdXBlcihLZXlJZE1ldGEuTkFNRSwgdmFsdWUpXG4gICAgfVxuXG59IiwiaW1wb3J0IHsgQWxnb3JpdGhtTWV0YSB9IGZyb20gXCIuL2hlYWRlci9hbGdvcml0aG1NZXRhLmpzXCI7XG5pbXBvcnQgeyBUeXBlTWV0YSB9IGZyb20gXCIuL2hlYWRlci90eXBlTWV0YS5qc1wiO1xuaW1wb3J0IHsgS2V5SWRNZXRhIH0gZnJvbSBcIi4vaGVhZGVyL2tleUlkTWV0YS5qc1wiO1xuXG5leHBvcnQgY2xhc3MgSnd0SGVhZGVyIHtcblxuICAgIGNvbnN0cnVjdG9yKG1ldGFPYmplY3QpIHtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQHR5cGUge0FsZ29yaXRobU1ldGF9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmFsZ29yaXRobSA9IHRoaXMuZ2V0TWV0YShtZXRhT2JqZWN0LCBBbGdvcml0aG1NZXRhLk5BTUUsIEFsZ29yaXRobU1ldGEpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAdHlwZSB7VHlwZU1ldGF9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnR5cGUgPSB0aGlzLmdldE1ldGEobWV0YU9iamVjdCwgVHlwZU1ldGEuTkFNRSwgVHlwZU1ldGEpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAdHlwZSB7VHlwZU1ldGF9XG4gICAgICAgICAqL1xuICAgICAgICAgdGhpcy5raWQgPSB0aGlzLmdldE1ldGEobWV0YU9iamVjdCwgS2V5SWRNZXRhLk5BTUUsIEtleUlkTWV0YSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogXG4gICAgICogQHBhcmFtIHsqfSBtZXRhT2JqZWN0IFxuICAgICAqIEBwYXJhbSB7Kn0gYXR0cmlidXRlTmFtZSBcbiAgICAgKi9cbiAgICBnZXRNZXRhKG1ldGFPYmplY3QsIGF0dHJpYnV0ZU5hbWUsIGNsYXNzTmFtZSkge1xuICAgICAgICBpZiAobWV0YU9iamVjdCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgbWV0YVZhbHVlID0gbWV0YU9iamVjdFthdHRyaWJ1dGVOYW1lXTtcbiAgICAgICAgaWYobWV0YVZhbHVlID09PSBudWxsIHx8IG1ldGFWYWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3IGNsYXNzTmFtZShtZXRhVmFsdWUpO1xuICAgIH1cblxufSIsImltcG9ydCB7IEp3dEJvZHkgfSBmcm9tIFwiLi9qd3RCb2R5LmpzXCI7XG5pbXBvcnQgeyBKd3RIZWFkZXIgfSBmcm9tIFwiLi9qd3RIZWFkZXIuanNcIjtcblxuZXhwb3J0IGNsYXNzIEp3dCB7XG5cbiAgICBjb25zdHJ1Y3RvcihzdHJpbmdTb3VyY2UsIGp3dEhlYWRlciwgand0Qm9keSkge1xuICAgICAgICAvKipcbiAgICAgICAgICogQHR5cGUge1N0cmluZ31cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuc291cmNlID0gc3RyaW5nU291cmNlO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAdHlwZSB7Snd0SGVhZGVyfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5oZWFkZXIgPSBqd3RIZWFkZXI7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEB0eXBlIHtKd3RCb2R5fVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5ib2R5ID0gand0Qm9keTtcbiAgICB9XG5cbn0iLCJpbXBvcnQgeyBKd3QgfSBmcm9tIFwiLi9tb2RlbC9qd3QuanNcIjtcbmltcG9ydCB7IEp3dEJvZHkgfSBmcm9tIFwiLi9tb2RlbC9qd3RCb2R5LmpzXCI7XG5pbXBvcnQgeyBKd3RIZWFkZXIgfSBmcm9tIFwiLi9tb2RlbC9qd3RIZWFkZXIuanNcIjtcblxuZXhwb3J0IGNsYXNzIEp3dFN0cmluZ1BhcnNlciB7XG5cbiAgICAvKipcbiAgICAgKiBcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gand0U3RyaW5nXG4gICAgICogQHJldHVybnMge0p3dH0gand0XG4gICAgICovXG4gICAgc3RhdGljIHBhcnNlU3RyaW5nKGp3dFN0cmluZykge1xuICAgICAgICAvKipcbiAgICAgICAgICogQHR5cGUgW0FycmF5XVxuICAgICAgICAgKi9cbiAgICAgICAgY29uc3Qgand0UGFydHMgPSBqd3RTdHJpbmcuc3BsaXQoXCIuXCIpO1xuICAgICAgICBpZihqd3RQYXJ0cy5sZW5ndGggPCAyKSB7XG4gICAgICAgICAgICB0aHJvdyBcIkpXVCBkb2VzIG5vdCBoYXZlIGEgYm9keVwiO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBjb25zdCBoZWFkZXJEZWNvZGVkID0gYXRvYihqd3RQYXJ0c1swXSk7XG4gICAgICAgIGNvbnN0IGhlYWRlck9iamVjdCA9IEpTT04ucGFyc2UoaGVhZGVyRGVjb2RlZCk7XG4gICAgICAgIGNvbnN0IGp3dEhlYWRlciA9IG5ldyBKd3RIZWFkZXIoaGVhZGVyT2JqZWN0KTtcblxuICAgICAgICBjb25zdCBib2R5RGVjb2RlZCA9IGF0b2Ioand0UGFydHNbMV0pO1xuICAgICAgICBjb25zdCBib2R5T2JqZWN0ID0gSlNPTi5wYXJzZShib2R5RGVjb2RlZCk7XG4gICAgICAgIGNvbnN0IGp3dEJvZHkgPSBuZXcgSnd0Qm9keShib2R5T2JqZWN0KTtcblxuICAgICAgICByZXR1cm4gbmV3IEp3dChqd3RTdHJpbmcsIGp3dEhlYWRlciwgand0Qm9keSk7XG4gICAgfVxuXG59Il0sIm5hbWVzIjpbIk1hcCIsIlN0cmluZ1V0aWxzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBTyxNQUFNLFFBQVEsQ0FBQztBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJLFdBQVcsQ0FBQyxJQUFJLEVBQUUsS0FBSyxFQUFFO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQztBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsSUFBSSxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUM7QUFDM0IsS0FBSztBQUNMO0FBQ0E7O0FDbEJPLE1BQU0sYUFBYSxTQUFTLFFBQVEsQ0FBQztBQUM1QztBQUNBLElBQUksV0FBVyxJQUFJLEdBQUcsRUFBRSxPQUFPLEtBQUssQ0FBQyxFQUFFO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJLFdBQVcsQ0FBQyxLQUFLLEVBQUU7QUFDdkIsUUFBUSxLQUFLLENBQUMsYUFBYSxDQUFDLElBQUksRUFBRSxLQUFLLENBQUMsQ0FBQztBQUN6QyxLQUFLO0FBQ0w7QUFDQSxJQUFJLElBQUksS0FBSyxHQUFHO0FBQ2hCLFFBQVEsT0FBTyxVQUFVLENBQUM7QUFDMUIsS0FBSztBQUNMOztBQ2ZPLE1BQU0sV0FBVyxTQUFTLFFBQVEsQ0FBQztBQUMxQztBQUNBLElBQUksV0FBVyxJQUFJLEdBQUcsRUFBRSxPQUFPLEtBQUssQ0FBQyxFQUFFO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJLFdBQVcsQ0FBQyxLQUFLLEVBQUU7QUFDdkIsUUFBUSxLQUFLLENBQUMsV0FBVyxDQUFDLElBQUksRUFBRSxLQUFLLENBQUMsQ0FBQztBQUN2QyxLQUFLO0FBQ0w7QUFDQSxJQUFJLElBQUksY0FBYyxHQUFHO0FBQ3pCLFFBQVEsTUFBTSxJQUFJLEdBQUcsSUFBSSxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUMsQ0FBQztBQUNqRCxRQUFRLE9BQU8sRUFBRSxHQUFHLElBQUksQ0FBQyxXQUFXLEVBQUUsR0FBRyxHQUFHO0FBQzVDLGlCQUFpQixJQUFJLENBQUMsUUFBUSxFQUFFLEdBQUcsQ0FBQyxDQUFDLEdBQUcsR0FBRztBQUMzQyxnQkFBZ0IsSUFBSSxDQUFDLE9BQU8sRUFBRSxHQUFHLEdBQUc7QUFDcEMsZ0JBQWdCLElBQUksQ0FBQyxRQUFRLEVBQUUsR0FBRyxHQUFHO0FBQ3JDLGdCQUFnQixJQUFJLENBQUMsVUFBVSxFQUFFLEdBQUcsR0FBRztBQUN2QyxnQkFBZ0IsSUFBSSxDQUFDLFVBQVUsRUFBRSxDQUFDO0FBQ2xDLEtBQUs7QUFDTDtBQUNBLElBQUksSUFBSSxLQUFLLEdBQUc7QUFDaEIsUUFBUSxPQUFPLFFBQVEsQ0FBQztBQUN4QixLQUFLO0FBQ0w7QUFDQTs7QUMxQk8sTUFBTSxXQUFXLFNBQVMsUUFBUSxDQUFDO0FBQzFDO0FBQ0EsSUFBSSxXQUFXLElBQUksR0FBRyxFQUFFLE9BQU8sS0FBSyxDQUFDLEVBQUU7QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUksV0FBVyxDQUFDLEtBQUssRUFBRTtBQUN2QixRQUFRLEtBQUssQ0FBQyxXQUFXLENBQUMsSUFBSSxFQUFFLEtBQUssQ0FBQyxDQUFDO0FBQ3ZDLEtBQUs7QUFDTDtBQUNBLElBQUksSUFBSSxLQUFLLEdBQUc7QUFDaEIsUUFBUSxPQUFPLFFBQVEsQ0FBQztBQUN4QixLQUFLO0FBQ0w7O0FDZk8sTUFBTSxVQUFVLFNBQVMsUUFBUSxDQUFDO0FBQ3pDO0FBQ0EsSUFBSSxXQUFXLElBQUksR0FBRyxFQUFFLE9BQU8sS0FBSyxDQUFDLEVBQUU7QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUksV0FBVyxDQUFDLEtBQUssRUFBRTtBQUN2QixRQUFRLEtBQUssQ0FBQyxVQUFVLENBQUMsSUFBSSxFQUFFLEtBQUssQ0FBQyxDQUFDO0FBQ3RDLEtBQUs7QUFDTDtBQUNBLElBQUksSUFBSSxLQUFLLEdBQUc7QUFDaEIsUUFBUSxPQUFPLFFBQVEsQ0FBQztBQUN4QixLQUFLO0FBQ0w7QUFDQTs7QUNoQk8sTUFBTSxjQUFjLFNBQVMsUUFBUSxDQUFDO0FBQzdDO0FBQ0EsSUFBSSxXQUFXLElBQUksR0FBRyxFQUFFLE9BQU8sS0FBSyxDQUFDLEVBQUU7QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUksV0FBVyxDQUFDLEtBQUssRUFBRTtBQUN2QixRQUFRLEtBQUssQ0FBQyxjQUFjLENBQUMsSUFBSSxFQUFFLEtBQUssQ0FBQyxDQUFDO0FBQzFDLEtBQUs7QUFDTDtBQUNBLElBQUksSUFBSSxjQUFjLEdBQUc7QUFDekIsUUFBUSxNQUFNLElBQUksR0FBRyxJQUFJLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQyxDQUFDO0FBQ2pELFFBQVEsT0FBTyxFQUFFLEdBQUcsSUFBSSxDQUFDLFdBQVcsRUFBRSxHQUFHLEdBQUc7QUFDNUMsaUJBQWlCLElBQUksQ0FBQyxRQUFRLEVBQUUsR0FBRyxDQUFDLENBQUMsR0FBRyxHQUFHO0FBQzNDLGdCQUFnQixJQUFJLENBQUMsT0FBTyxFQUFFLEdBQUcsR0FBRztBQUNwQyxnQkFBZ0IsSUFBSSxDQUFDLFFBQVEsRUFBRSxHQUFHLEdBQUc7QUFDckMsZ0JBQWdCLElBQUksQ0FBQyxVQUFVLEVBQUUsR0FBRyxHQUFHO0FBQ3ZDLGdCQUFnQixJQUFJLENBQUMsVUFBVSxFQUFFLENBQUM7QUFDbEMsS0FBSztBQUNMO0FBQ0EsSUFBSSxJQUFJLEtBQUssR0FBRztBQUNoQixRQUFRLE9BQU8sWUFBWSxDQUFDO0FBQzVCLEtBQUs7QUFDTDtBQUNBOztBQzFCTyxNQUFNLFlBQVksU0FBUyxRQUFRLENBQUM7QUFDM0M7QUFDQSxJQUFJLFdBQVcsSUFBSSxHQUFHLEVBQUUsT0FBTyxLQUFLLENBQUMsRUFBRTtBQUN2QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSSxXQUFXLENBQUMsS0FBSyxFQUFFO0FBQ3ZCLFFBQVEsS0FBSyxDQUFDLFlBQVksQ0FBQyxJQUFJLEVBQUUsS0FBSyxDQUFDLENBQUM7QUFDeEMsS0FBSztBQUNMO0FBQ0EsSUFBSSxJQUFJLEtBQUssR0FBRztBQUNoQixRQUFRLE9BQU8sU0FBUyxDQUFDO0FBQ3pCLEtBQUs7QUFDTDs7QUNmTyxNQUFNLGFBQWEsU0FBUyxRQUFRLENBQUM7QUFDNUM7QUFDQSxJQUFJLFdBQVcsSUFBSSxHQUFHLEVBQUUsT0FBTyxLQUFLLENBQUMsRUFBRTtBQUN2QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSSxXQUFXLENBQUMsS0FBSyxFQUFFO0FBQ3ZCLFFBQVEsS0FBSyxDQUFDLGFBQWEsQ0FBQyxJQUFJLEVBQUUsS0FBSyxDQUFDLENBQUM7QUFDekMsS0FBSztBQUNMO0FBQ0EsSUFBSSxJQUFJLGNBQWMsR0FBRztBQUN6QixRQUFRLE1BQU0sSUFBSSxHQUFHLElBQUksSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLEdBQUcsSUFBSSxDQUFDLENBQUM7QUFDakQsUUFBUSxPQUFPLEVBQUUsR0FBRyxJQUFJLENBQUMsV0FBVyxFQUFFLEdBQUcsR0FBRztBQUM1QyxpQkFBaUIsSUFBSSxDQUFDLFFBQVEsRUFBRSxHQUFHLENBQUMsQ0FBQyxHQUFHLEdBQUc7QUFDM0MsZ0JBQWdCLElBQUksQ0FBQyxPQUFPLEVBQUUsR0FBRyxHQUFHO0FBQ3BDLGdCQUFnQixJQUFJLENBQUMsUUFBUSxFQUFFLEdBQUcsR0FBRztBQUNyQyxnQkFBZ0IsSUFBSSxDQUFDLFVBQVUsRUFBRSxHQUFHLEdBQUc7QUFDdkMsZ0JBQWdCLElBQUksQ0FBQyxVQUFVLEVBQUUsQ0FBQztBQUNsQyxLQUFLO0FBQ0w7QUFDQSxJQUFJLElBQUksS0FBSyxHQUFHO0FBQ2hCLFFBQVEsT0FBTyxXQUFXLENBQUM7QUFDM0IsS0FBSztBQUNMO0FBQ0E7O0FDakJPLE1BQU0sT0FBTyxDQUFDO0FBQ3JCO0FBQ0EsSUFBSSxXQUFXLENBQUMsWUFBWSxHQUFHLElBQUksRUFBRTtBQUNyQztBQUNBLFFBQVEsSUFBSSxDQUFDLFdBQVcsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLFlBQVksQ0FBQyxDQUFDO0FBQ3BEO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSSxZQUFZLENBQUMsS0FBSyxFQUFFLFNBQVMsRUFBRTtBQUNuQyxRQUFRLE9BQU8sSUFBSSxTQUFTLENBQUMsS0FBSyxDQUFDLENBQUM7QUFDcEMsS0FBSztBQUNMO0FBQ0EsSUFBSSxLQUFLLENBQUMsWUFBWSxFQUFFO0FBQ3hCLFFBQVEsTUFBTSxXQUFXLEdBQUcsSUFBSUEsZUFBRyxFQUFFLENBQUM7QUFDdEMsUUFBUSxJQUFJLFlBQVksS0FBSyxJQUFJLEVBQUU7QUFDbkMsWUFBWSxPQUFPLFdBQVcsQ0FBQztBQUMvQixTQUFTO0FBQ1QsUUFBUSxNQUFNLE1BQU0sQ0FBQyxHQUFHLEVBQUUsS0FBSyxDQUFDLElBQUksTUFBTSxDQUFDLE9BQU8sQ0FBQyxZQUFZLENBQUMsRUFBRTtBQUNsRSxZQUFZLFdBQVcsQ0FBQyxHQUFHLENBQUMsR0FBRyxFQUFFLElBQUksQ0FBQyxhQUFhLENBQUMsR0FBRyxFQUFFLEtBQUssQ0FBQyxDQUFDLENBQUM7QUFDakUsU0FBUztBQUNULFFBQVEsT0FBTyxXQUFXLENBQUM7QUFDM0IsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUksYUFBYSxDQUFDLElBQUksRUFBRTtBQUN4QixRQUFRLE9BQU8sSUFBSSxDQUFDLFdBQVcsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUM7QUFDMUMsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUssa0JBQWtCLENBQUMsSUFBSSxFQUFFO0FBQzlCLFFBQVEsSUFBSSxJQUFJLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsRUFBRTtBQUN4QyxZQUFZLE9BQU8sSUFBSSxDQUFDLFdBQVcsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUMsS0FBSyxDQUFDO0FBQ3BELFNBQVM7QUFDVCxRQUFRLE9BQU8sSUFBSSxDQUFDO0FBQ3BCLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUksYUFBYSxDQUFDLEdBQUcsRUFBRSxLQUFLLEVBQUU7QUFDOUI7QUFDQSxRQUFRLElBQUlDLHVCQUFXLENBQUMsYUFBYSxDQUFDLEdBQUcsRUFBRSxZQUFZLENBQUMsSUFBSSxDQUFDLEVBQUU7QUFDL0QsWUFBWSxPQUFPLElBQUksQ0FBQyxZQUFZLENBQUMsS0FBSyxFQUFFLFlBQVksQ0FBQyxDQUFDO0FBQzFELFNBQVM7QUFDVCxRQUFRLElBQUlBLHVCQUFXLENBQUMsYUFBYSxDQUFDLEdBQUcsRUFBRSxXQUFXLENBQUMsSUFBSSxDQUFDLEVBQUU7QUFDOUQsWUFBWSxPQUFPLElBQUksQ0FBQyxZQUFZLENBQUMsS0FBSyxFQUFFLFdBQVcsQ0FBQyxDQUFDO0FBQ3pELFNBQVM7QUFDVCxRQUFRLElBQUlBLHVCQUFXLENBQUMsYUFBYSxDQUFDLEdBQUcsRUFBRSxhQUFhLENBQUMsSUFBSSxDQUFDLEVBQUU7QUFDaEUsWUFBWSxPQUFPLElBQUksQ0FBQyxZQUFZLENBQUMsS0FBSyxFQUFFLGFBQWEsQ0FBQyxDQUFDO0FBQzNELFNBQVM7QUFDVCxRQUFRLElBQUlBLHVCQUFXLENBQUMsYUFBYSxDQUFDLEdBQUcsRUFBRSxVQUFVLENBQUMsSUFBSSxDQUFDLEVBQUU7QUFDN0QsWUFBWSxPQUFPLElBQUksQ0FBQyxZQUFZLENBQUMsS0FBSyxFQUFFLFVBQVUsQ0FBQyxDQUFDO0FBQ3hELFNBQVM7QUFDVCxRQUFRLElBQUlBLHVCQUFXLENBQUMsYUFBYSxDQUFDLEdBQUcsRUFBRSxXQUFXLENBQUMsSUFBSSxDQUFDLEVBQUU7QUFDOUQsWUFBWSxPQUFPLElBQUksQ0FBQyxZQUFZLENBQUMsS0FBSyxFQUFFLFdBQVcsQ0FBQyxDQUFDO0FBQ3pELFNBQVM7QUFDVCxRQUFRLElBQUlBLHVCQUFXLENBQUMsYUFBYSxDQUFDLEdBQUcsRUFBRSxjQUFjLENBQUMsSUFBSSxDQUFDLEVBQUU7QUFDakUsWUFBWSxPQUFPLElBQUksQ0FBQyxZQUFZLENBQUMsS0FBSyxFQUFFLGNBQWMsQ0FBQyxDQUFDO0FBQzVELFNBQVM7QUFDVCxRQUFRLElBQUlBLHVCQUFXLENBQUMsYUFBYSxDQUFDLEdBQUcsRUFBRSxhQUFhLENBQUMsSUFBSSxDQUFDLEVBQUU7QUFDaEUsWUFBWSxPQUFPLElBQUksQ0FBQyxZQUFZLENBQUMsS0FBSyxFQUFFLGFBQWEsQ0FBQyxDQUFDO0FBQzNELFNBQVM7QUFDVCxRQUFRLE9BQU8sSUFBSSxRQUFRLENBQUMsR0FBRyxFQUFFLEtBQUssQ0FBQyxDQUFDO0FBQ3hDO0FBQ0EsS0FBSztBQUNMO0FBQ0EsSUFBSSxJQUFJLEdBQUcsR0FBRztBQUNkLFFBQVEsT0FBTyxJQUFJLENBQUMsa0JBQWtCLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxDQUFDO0FBQzFELEtBQUs7QUFDTDtBQUNBLElBQUksSUFBSSxHQUFHLEdBQUc7QUFDZCxRQUFRLE9BQU8sSUFBSSxDQUFDLGtCQUFrQixDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUN6RCxLQUFLO0FBQ0w7QUFDQSxJQUFJLElBQUksR0FBRyxHQUFHO0FBQ2QsUUFBUSxPQUFPLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxhQUFhLENBQUMsSUFBSSxDQUFDLENBQUM7QUFDM0QsS0FBSztBQUNMO0FBQ0EsSUFBSSxJQUFJLEdBQUcsR0FBRztBQUNkLFFBQVEsT0FBTyxJQUFJLENBQUMsa0JBQWtCLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxDQUFDO0FBQ3hELEtBQUs7QUFDTDtBQUNBLElBQUksSUFBSSxHQUFHLEdBQUc7QUFDZCxRQUFRLE9BQU8sSUFBSSxDQUFDLGtCQUFrQixDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUN6RCxLQUFLO0FBQ0w7QUFDQSxJQUFJLElBQUksR0FBRyxHQUFHO0FBQ2QsUUFBUSxPQUFPLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLENBQUM7QUFDNUQsS0FBSztBQUNMO0FBQ0EsSUFBSSxJQUFJLEdBQUcsR0FBRztBQUNkLFFBQVEsT0FBTyxJQUFJLENBQUMsa0JBQWtCLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxDQUFDO0FBQzNELEtBQUs7QUFDTDs7QUN2SE8sTUFBTSxhQUFhLFNBQVMsUUFBUSxDQUFDO0FBQzVDO0FBQ0EsSUFBSSxXQUFXLElBQUksR0FBRyxFQUFFLE9BQU8sS0FBSyxDQUFDLEVBQUU7QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUksV0FBVyxDQUFDLEtBQUssRUFBRTtBQUN2QixRQUFRLEtBQUssQ0FBQyxhQUFhLENBQUMsSUFBSSxFQUFFLEtBQUssRUFBQztBQUN4QyxLQUFLO0FBQ0w7QUFDQTs7QUNaTyxNQUFNLFFBQVEsU0FBUyxRQUFRLENBQUM7QUFDdkM7QUFDQSxJQUFJLFdBQVcsSUFBSSxHQUFHLEVBQUUsT0FBTyxLQUFLLENBQUMsRUFBRTtBQUN2QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSSxXQUFXLENBQUMsS0FBSyxFQUFFO0FBQ3ZCLFFBQVEsS0FBSyxDQUFDLFFBQVEsQ0FBQyxJQUFJLEVBQUUsS0FBSyxFQUFDO0FBQ25DLEtBQUs7QUFDTDtBQUNBOztBQ1pPLE1BQU0sU0FBUyxTQUFTLFFBQVEsQ0FBQztBQUN4QztBQUNBLElBQUksV0FBVyxJQUFJLEdBQUcsRUFBRSxPQUFPLEtBQUssQ0FBQyxFQUFFO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJLFdBQVcsQ0FBQyxLQUFLLEVBQUU7QUFDdkIsUUFBUSxLQUFLLENBQUMsU0FBUyxDQUFDLElBQUksRUFBRSxLQUFLLEVBQUM7QUFDcEMsS0FBSztBQUNMO0FBQ0E7O0FDVk8sTUFBTSxTQUFTLENBQUM7QUFDdkI7QUFDQSxJQUFJLFdBQVcsQ0FBQyxVQUFVLEVBQUU7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLElBQUksQ0FBQyxTQUFTLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxVQUFVLEVBQUUsYUFBYSxDQUFDLElBQUksRUFBRSxhQUFhLENBQUMsQ0FBQztBQUNyRjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLFVBQVUsRUFBRSxRQUFRLENBQUMsSUFBSSxFQUFFLFFBQVEsQ0FBQyxDQUFDO0FBQ3RFO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUyxJQUFJLENBQUMsR0FBRyxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsVUFBVSxFQUFFLFNBQVMsQ0FBQyxJQUFJLEVBQUUsU0FBUyxDQUFDLENBQUM7QUFDeEUsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUksT0FBTyxDQUFDLFVBQVUsRUFBRSxhQUFhLEVBQUUsU0FBUyxFQUFFO0FBQ2xELFFBQVEsSUFBSSxVQUFVLEtBQUssSUFBSSxFQUFFO0FBQ2pDLFlBQVksT0FBTyxJQUFJLENBQUM7QUFDeEIsU0FBUztBQUNULFFBQVEsTUFBTSxTQUFTLEdBQUcsVUFBVSxDQUFDLGFBQWEsQ0FBQyxDQUFDO0FBQ3BELFFBQVEsR0FBRyxTQUFTLEtBQUssSUFBSSxJQUFJLFNBQVMsS0FBSyxTQUFTLEVBQUU7QUFDMUQsWUFBWSxPQUFPLElBQUksQ0FBQztBQUN4QixTQUFTO0FBQ1QsUUFBUSxPQUFPLElBQUksU0FBUyxDQUFDLFNBQVMsQ0FBQyxDQUFDO0FBQ3hDLEtBQUs7QUFDTDtBQUNBOztBQ3JDTyxNQUFNLEdBQUcsQ0FBQztBQUNqQjtBQUNBLElBQUksV0FBVyxDQUFDLFlBQVksRUFBRSxTQUFTLEVBQUUsT0FBTyxFQUFFO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsSUFBSSxDQUFDLE1BQU0sR0FBRyxZQUFZLENBQUM7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLElBQUksQ0FBQyxNQUFNLEdBQUcsU0FBUyxDQUFDO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSxJQUFJLENBQUMsSUFBSSxHQUFHLE9BQU8sQ0FBQztBQUM1QixLQUFLO0FBQ0w7QUFDQTs7QUNsQk8sTUFBTSxlQUFlLENBQUM7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSSxPQUFPLFdBQVcsQ0FBQyxTQUFTLEVBQUU7QUFDbEM7QUFDQTtBQUNBO0FBQ0EsUUFBUSxNQUFNLFFBQVEsR0FBRyxTQUFTLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0FBQzlDLFFBQVEsR0FBRyxRQUFRLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRTtBQUNoQyxZQUFZLE1BQU0sMEJBQTBCLENBQUM7QUFDN0MsU0FBUztBQUNUO0FBQ0EsUUFBUSxNQUFNLGFBQWEsR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDaEQsUUFBUSxNQUFNLFlBQVksR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLGFBQWEsQ0FBQyxDQUFDO0FBQ3ZELFFBQVEsTUFBTSxTQUFTLEdBQUcsSUFBSSxTQUFTLENBQUMsWUFBWSxDQUFDLENBQUM7QUFDdEQ7QUFDQSxRQUFRLE1BQU0sV0FBVyxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUM5QyxRQUFRLE1BQU0sVUFBVSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsV0FBVyxDQUFDLENBQUM7QUFDbkQsUUFBUSxNQUFNLE9BQU8sR0FBRyxJQUFJLE9BQU8sQ0FBQyxVQUFVLENBQUMsQ0FBQztBQUNoRDtBQUNBLFFBQVEsT0FBTyxJQUFJLEdBQUcsQ0FBQyxTQUFTLEVBQUUsU0FBUyxFQUFFLE9BQU8sQ0FBQyxDQUFDO0FBQ3RELEtBQUs7QUFDTDtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7In0=
